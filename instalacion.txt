pip uninstall -r requirements.txt -y
cd hgw-chatbot
cd backend
py -m venv venv
source venv/Scripts/activate
pip install -r requirements.txt
uvicorn app:app --reload --port 8000

# En la carpeta backend con el entorno virtual activado
python

>>> from database import engine, Base
>>> from models import *
>>> Base.metadata.create_all(bind=engine)
>>> exit()

ngrok http 8000

cd hgw-chatbot
cd frontend-react
npm install @mui/icons-material
npm run start


pip uninstall -r requirements.txt -y

Vamos a verificar paso a paso que todo esté configurado correctamente para que aparezcan los endpoints de inventory en Swagger.

## 1. Primero, verifica la estructura de carpetas:

```bash
# Desde la carpeta backend
ls -la app/
ls -la app/api/
ls -la app/api/v1/
ls -la app/models/
```

## 2. Verifica que el archivo `inventory.py` existe en la carpeta correcta:

```bash
ls -la app/api/v1/inventory.py
```

Si NO existe, créalo:

```bash
# Crear el archivo de rutas de inventory
cat > app/api/v1/inventory.py << 'EOF'
"""
Endpoints para el sistema de inventario y ventas
"""

from fastapi import APIRouter, Depends, HTTPException, Query
from sqlalchemy.orm import Session
from sqlalchemy import or_, func
from typing import List, Optional
from datetime import datetime, date

from ...database import get_db

router = APIRouter(prefix="/inventory", tags=["inventory"])

# ===============================================
# ENDPOINTS DE PRUEBA
# ===============================================

@router.get("/test")
async def test_inventory():
    """Endpoint de prueba para verificar que el módulo funciona"""
    return {"message": "Módulo de inventario funcionando correctamente"}

@router.get("/vendedores")
async def get_vendedores(
    skip: int = 0,
    limit: int = Query(default=100, le=1000),
    db: Session = Depends(get_db)
):
    """Obtiene todos los vendedores"""
    from sqlalchemy import text
    
    try:
        result = db.execute(text("SELECT * FROM vendedores LIMIT :limit OFFSET :skip"), 
                           {"limit": limit, "skip": skip})
        vendedores = []
        for row in result:
            vendedores.append({
                "id": row[0],
                "nombre": row[1],
                "telefono": row[2],
                "email": row[3],
                "ciudad": row[5],
                "estado": row[6]
            })
        return vendedores
    except Exception as e:
        raise HTTPException(status_code=500, detail=str(e))

@router.get("/productos")
async def get_productos(
    skip: int = 0,
    limit: int = Query(default=100, le=1000),
    db: Session = Depends(get_db)
):
    """Obtiene todos los productos"""
    from sqlalchemy import text
    
    try:
        result = db.execute(text("SELECT * FROM productos LIMIT :limit OFFSET :skip"), 
                           {"limit": limit, "skip": skip})
        productos = []
        for row in result:
            productos.append({
                "id": row[0],
                "nombre": row[1],
                "descripcion": row[2],
                "codigo": row[3],
                "precio_unitario": float(row[4]) if row[4] else 0,
                "categoria": row[5],
                "estado": row[6]
            })
        return productos
    except Exception as e:
        raise HTTPException(status_code=500, detail=str(e))

@router.post("/vendedores")
async def create_vendedor(
    nombre: str,
    telefono: str,
    ciudad: Optional[str] = None,
    email: Optional[str] = None,
    db: Session = Depends(get_db)
):
    """Crea un nuevo vendedor"""
    from sqlalchemy import text
    
    try:
        query = text("""
            INSERT INTO vendedores (nombre, telefono, ciudad, email) 
            VALUES (:nombre, :telefono, :ciudad, :email)
        """)
        
        db.execute(query, {
            "nombre": nombre,
            "telefono": telefono,
            "ciudad": ciudad,
            "email": email
        })
        db.commit()
        
        return {"message": "Vendedor creado exitosamente"}
    except Exception as e:
        db.rollback()
        raise HTTPException(status_code=400, detail=str(e))

@router.post("/productos")
async def create_producto(
    nombre: str,
    codigo: str,
    precio_unitario: float,
    categoria: Optional[str] = None,
    descripcion: Optional[str] = None,
    db: Session = Depends(get_db)
):
    """Crea un nuevo producto"""
    from sqlalchemy import text
    
    try:
        query = text("""
            INSERT INTO productos (nombre, codigo, precio_unitario, categoria, descripcion) 
            VALUES (:nombre, :codigo, :precio, :categoria, :descripcion)
        """)
        
        db.execute(query, {
            "nombre": nombre,
            "codigo": codigo,
            "precio": precio_unitario,
            "categoria": categoria,
            "descripcion": descripcion
        })
        db.commit()
        
        return {"message": "Producto creado exitosamente"}
    except Exception as e:
        db.rollback()
        raise HTTPException(status_code=400, detail=str(e))

@router.get("/estadisticas/general")
async def get_estadisticas(db: Session = Depends(get_db)):
    """Obtiene estadísticas generales del inventario"""
    from sqlalchemy import text
    
    try:
        # Contar vendedores
        vendedores = db.execute(text("SELECT COUNT(*) FROM vendedores")).scalar()
        
        # Contar productos
        productos = db.execute(text("SELECT COUNT(*) FROM productos")).scalar()
        
        # Stock total
        stock = db.execute(text("SELECT COALESCE(SUM(cantidad_actual), 0) FROM stock_vendedores")).scalar()
        
        # Ventas totales
        ventas = db.execute(text("SELECT COUNT(*) FROM ventas_vendedor")).scalar()
        
        return {
            "total_vendedores": vendedores,
            "total_productos": productos,
            "stock_total": stock,
            "total_ventas": ventas
        }
    except Exception as e:
        raise HTTPException(status_code=500, detail=str(e))
EOF
```

## 3. Actualiza el archivo `__init__.py`:

```bash
cat > app/api/v1/__init__.py << 'EOF'
"""
API v1 routers
"""

# Importar todos los routers disponibles
try:
    from .chatbot import router as chatbot
except ImportError:
    chatbot = None
    print("⚠️ No se pudo importar chatbot")

try:
    from .distributors import router as distributors
except ImportError:
    distributors = None
    print("⚠️ No se pudo importar distributors")

try:
    from .conversations import router as conversations
except ImportError:
    conversations = None
    print("⚠️ No se pudo importar conversations")

try:
    from .leads import router as leads
except ImportError:
    leads = None
    print("⚠️ No se pudo importar leads")

try:
    from .admin import router as admin
except ImportError:
    admin = None
    print("⚠️ No se pudo importar admin")

try:
    from .stats import router as stats
except ImportError:
    stats = None
    print("⚠️ No se pudo importar stats")

try:
    from .inventory import router as inventory
except ImportError:
    inventory = None
    print("⚠️ No se pudo importar inventory")

# Exportar los que estén disponibles
__all__ = [
    "chatbot",
    "distributors",
    "conversations",
    "leads",
    "admin",
    "stats",
    "inventory"
]
EOF
```

## 4. Verifica main.py o app.py (el que uses):

Si usas `app.py`, ábrelo y busca donde se incluyen los routers. Debe verse algo así:

```python
# Busca esta sección en tu app.py
app.include_router(admin_router, prefix="/api/admin", tags=["Admin"])
app.include_router(distributor_router, prefix="/api/distributors", tags=["Distributors"])

# Y agrega esta línea después:
from app.api.v1 import inventory
app.include_router(inventory.router, prefix="/api/v1", tags=["Inventory"])
```

O si usas `app/main.py`, verifica que tenga:

```python
from .api.v1 import inventory

# Y más abajo:
app.include_router(
    inventory.router,
    prefix="/api/v1",
    tags=["inventario"]
)
```

## 5. Reinicia el servidor:

```bash
# Detén el servidor con Ctrl+C y vuélvelo a iniciar
python app.py
```

## 6. Verifica en el navegador:

1. Ve a: `http://localhost:8000/api/docs`
2. Busca la sección "Inventory" o "inventario"
3. Prueba el endpoint: `http://localhost:8000/api/v1/inventory/test`

## 7. Si aún no aparece, verifica qué archivo estás ejecutando:

```bash
# Muestra el contenido del archivo que ejecutas
head -50 app.py
```

**Comparte conmigo:**
1. ¿Qué mensaje aparece cuando inicias el servidor?
2. ¿Ves algún error de importación?
3. ¿Qué aparece cuando vas a `http://localhost:8000/api/v1/inventory/test`?